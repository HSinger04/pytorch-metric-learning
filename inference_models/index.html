


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="shortcut icon" href="../imgs/Favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-5.5.0">
    
    
      
        <title>Inference Models - PyTorch Metric Learning</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.b5d04df8.min.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/palette.9ab2c1f8.min.css">
      
      
        
        
        <meta name="theme-color" content="#ef5350">
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="red" data-md-color-accent="red">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#inference-models" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href=".." title="PyTorch Metric Learning" class="md-header-nav__button md-logo" aria-label="PyTorch Metric Learning">
      
  <img src="../imgs/TinyLogo.png" alt="logo">

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            PyTorch Metric Learning
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Inference Models
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/KevinMusgrave/pytorch-metric-learning/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    KevinMusgrave/pytorch-metric-learning
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="PyTorch Metric Learning" class="md-nav__button md-logo" aria-label="PyTorch Metric Learning">
      
  <img src="../imgs/TinyLogo.png" alt="logo">

    </a>
    PyTorch Metric Learning
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/KevinMusgrave/pytorch-metric-learning/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    KevinMusgrave/pytorch-metric-learning
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../distances/" title="Distances" class="md-nav__link">
      Distances
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../losses/" title="Losses" class="md-nav__link">
      Losses
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../miners/" title="Miners" class="md-nav__link">
      Miners
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../reducers/" title="Reducers" class="md-nav__link">
      Reducers
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../regularizers/" title="Regularizers" class="md-nav__link">
      Regularizers
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../samplers/" title="Samplers" class="md-nav__link">
      Samplers
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../trainers/" title="Trainers" class="md-nav__link">
      Trainers
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../testers/" title="Testers" class="md-nav__link">
      Testers
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10" checked>
    
    <label class="md-nav__link" for="nav-10">
      Utils
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Utils" data-md-level="1">
      <label class="md-nav__title" for="nav-10">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Utils
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../accuracy_calculation/" title="Accuracy Calculation" class="md-nav__link">
      Accuracy Calculation
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Inference Models
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 9h14V7H3v2m0 4h14v-2H3v2m0 4h14v-2H3v2m16 0h2v-2h-2v2m0-10v2h2V7h-2m0 6h2v-2h-2v2z"/></svg>
        </span>
      </label>
    
    <a href="./" title="Inference Models" class="md-nav__link md-nav__link--active">
      Inference Models
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#inferencemodel" class="md-nav__link">
    InferenceModel
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#matchfinder" class="md-nav__link">
    MatchFinder
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#faissindexer" class="md-nav__link">
    FaissIndexer
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#logitgetter" class="md-nav__link">
    LogitGetter
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../logging_presets/" title="Logging Presets" class="md-nav__link">
      Logging Presets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../common_functions/" title="Common Functions" class="md-nav__link">
      Common Functions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../distributed/" title="Distributed" class="md-nav__link">
      Distributed
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-11" type="checkbox" id="nav-11">
    
    <label class="md-nav__link" for="nav-11">
      How to extend this library
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="How to extend this library" data-md-level="1">
      <label class="md-nav__title" for="nav-11">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        How to extend this library
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../extend/losses/" title="Custom losses" class="md-nav__link">
      Custom losses
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../extend/miners/" title="Custom miners" class="md-nav__link">
      Custom miners
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#inferencemodel" class="md-nav__link">
    InferenceModel
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#matchfinder" class="md-nav__link">
    MatchFinder
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#faissindexer" class="md-nav__link">
    FaissIndexer
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#logitgetter" class="md-nav__link">
    LogitGetter
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/KevinMusgrave/pytorch-metric-learning/edit/master/docs/inference_models.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  
                
                
                <h1 id="inference-models">Inference Models<a class="headerlink" href="#inference-models" title="Permanent link">&para;</a></h1>
<p>utils.inference contains classes that make it convenient to find matching pairs within a batch, or from a set of pairs. Take a look at <a href="https://colab.research.google.com/github/KevinMusgrave/pytorch-metric-learning/blob/master/examples/notebooks/Inference.ipynb">this notebook</a> to see example usage.</p>
<h2 id="inferencemodel">InferenceModel<a class="headerlink" href="#inferencemodel" title="Permanent link">&para;</a></h2>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">pytorch_metric_learning.utils.inference</span> <span class="kn">import</span> <span class="n">InferenceModel</span>
<span class="n">InferenceModel</span><span class="p">(</span><span class="n">trunk</span><span class="p">,</span> 
                <span class="n">embedder</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                <span class="n">match_finder</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                <span class="n">indexer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">normalize_embeddings</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>


<p><strong>Parameters</strong>:</p>
<ul>
<li><strong>trunk</strong>: Your trained model for computing embeddings.</li>
<li><strong>embedder</strong>: Optional. This is if your model is split into two components (trunk and embedder). If None, then the embedder will simply return the trunk's output.</li>
<li><strong>match_finder</strong>: A <a href="./#matchfinder">MatchFinder</a> object. If <code>None</code>, it will be set to <code>MatchFinder(distance=CosineSimilarity(), threshold=0.9)</code>.</li>
<li><strong>indexer</strong>: The object used for computing k-nearest-neighbors. If <code>None</code>, it will be set to <code>FaissIndexer()</code>.</li>
<li><strong>normalize_embeddings</strong>: If True, embeddings will be normalized to have Euclidean norm of 1.</li>
</ul>
<p><strong>Methods</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># initialize with a model</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">InferenceModel</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

<span class="c1"># pass in a dataset to serve as the search space for k-nn</span>
<span class="n">im</span><span class="o">.</span><span class="n">train_indexer</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>

<span class="c1"># add another dataset to the index</span>
<span class="n">im</span><span class="o">.</span><span class="n">add_to_indexer</span><span class="p">(</span><span class="n">dataset2</span><span class="p">)</span>

<span class="c1"># get the 10 nearest neighbors of a query</span>
<span class="n">indices</span><span class="p">,</span> <span class="n">distances</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">get_nearest_neighbors</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># determine if inputs are close to each other</span>
<span class="n">is_match</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">is_match</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="c1"># determine &quot;is_match&quot; pairwise for all elements in a batch</span>
<span class="n">match_matrix</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">get_matches</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="c1"># save and load faiss index</span>
<span class="n">im</span><span class="o">.</span><span class="n">save_index</span><span class="p">(</span><span class="s2">&quot;filename.index&quot;</span><span class="p">)</span>
<span class="n">im</span><span class="o">.</span><span class="n">load_index</span><span class="p">(</span><span class="s2">&quot;filename.index&quot;</span><span class="p">)</span>
</code></pre></div>


<h2 id="matchfinder">MatchFinder<a class="headerlink" href="#matchfinder" title="Permanent link">&para;</a></h2>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">pytorch_metric_learning.utils.inference</span> <span class="kn">import</span> <span class="n">MatchFinder</span>
<span class="n">MatchFinder</span><span class="p">(</span><span class="n">distance</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>


<p><strong>Parameters</strong>:</p>
<ul>
<li><strong>distance</strong>: A <a href="../distances/">distance</a> object.</li>
<li><strong>threshold</strong>: Optional. Pairs will be a match if they fall under this threshold for non-inverted distances, or over this value for inverted distances. If not provided, then a threshold must be provided during function calls.</li>
</ul>
<h2 id="faissindexer">FaissIndexer<a class="headerlink" href="#faissindexer" title="Permanent link">&para;</a></h2>
<p>This will create a faiss index, specifically <code>IndexFlatL2</code>, which can be used for nearest neighbor retrieval.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">pytorch_metric_learning.utils.inference</span> <span class="kn">import</span> <span class="n">FaissIndexer</span>
<span class="n">FaissIndexer</span><span class="p">()</span>
</code></pre></div>


<h2 id="logitgetter">LogitGetter<a class="headerlink" href="#logitgetter" title="Permanent link">&para;</a></h2>
<p>This class makes it easier to extract logits from classifier loss functions. Although "metric learning" usually means that you use embeddings during inference, there might be cases where you want to use the class logits instead of the embeddings.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">pytorch_metric_learning.utils.inference</span> <span class="kn">import</span> <span class="n">LogitGetter</span>
<span class="n">LogitGetter</span><span class="p">(</span>
        <span class="n">classifier</span><span class="p">,</span>
        <span class="n">layer_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">transpose</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">distance</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">copy_weights</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">):</span>
</code></pre></div>


<p><strong>Parameters</strong>:</p>
<ul>
<li><strong>classifier</strong>: The classifier loss function that you want to extract logits from.</li>
<li><strong>layer_name</strong>: Optional. The attribute name of the weight matrix inside the classifier. If not specified, each of the following will be tried: <code>["fc", "proxies", "W"]</code>.</li>
<li><strong>transpose</strong>: Optional. Whether or not to transpose the weight matrix. If the weight matrix is of size <code>(embedding_size, num_classes)</code>, then it should be transposed. If not specified, then transposing will be done automatically during the <code>forward</code> call if necessary, based on the shapes of the input embeddings and the weight matrix. (Note that it is only guaranteed to make the correct transposing decision if <code>num_classes != embedding_size</code>.)</li>
<li><strong>distance</strong>: Optional. A <a href="../distances/">distance</a> object which will compute the distance or similarity matrix, i.e. the logits. If not specified, then <code>classifier.distance</code> will be used.</li>
<li><strong>copy_weights</strong>: If True, then LogitGetter will contain a copy of (instead of a reference to) the classifier weights, so that if you update the classifier weights, the LogitGetter remains unchanged.</li>
</ul>
<p>Example usage:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">pytorch_metric_learning.losses</span> <span class="kn">import</span> <span class="n">ArcFaceLoss</span>
<span class="kn">from</span> <span class="nn">pytorch_metric_learning.utils.inference</span> <span class="kn">import</span> <span class="n">LogitGetter</span>

<span class="n">loss_fn</span> <span class="o">=</span> <span class="n">ArcFaceLoss</span><span class="p">(</span><span class="n">num_classes</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">embedding_size</span> <span class="o">=</span> <span class="mi">512</span><span class="p">)</span>
<span class="n">LG</span> <span class="o">=</span> <span class="n">LogitGetter</span><span class="p">(</span><span class="n">loss_fn</span><span class="p">)</span>
<span class="n">logits</span> <span class="o">=</span> <span class="n">LG</span><span class="p">(</span><span class="n">embeddings</span><span class="p">)</span>
</code></pre></div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../accuracy_calculation/" title="Accuracy Calculation" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Accuracy Calculation
              </div>
            </div>
          </a>
        
        
          <a href="../logging_presets/" title="Logging Presets" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Logging Presets
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/vendor.92ffa368.min.js"></script>
      <script src="../assets/javascripts/bundle.5123e3d4.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "..",
          features: [],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.a68abb33.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>